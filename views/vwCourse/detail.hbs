<div>
  {{#if this.isEmpty}}
  <p>No Data</p>
  {{else}}
  <div class="card mb-3">
    <img
      src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxASEBUPEBIVFRUVFRUVFRUVFRUVFRUVFRcWFhUVFRUYHSggGBolHRUVITEhJSkrLi4uFx8zODMtNygtLisBCgoKBQUFDgUFDisZExkrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrK//AABEIALEBHAMBIgACEQEDEQH/xAAZAAEBAQEBAQAAAAAAAAAAAAAAAQIDBAf/xAAeEAEBAQEAAgIDAAAAAAAAAAAAARECEnFR8CGh4f/EABQBAQAAAAAAAAAAAAAAAAAAAAD/xAAUEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwD4csJGpAINY1IDOEjWGAyjRgMo1iYCI1iUGUaQEAAABQAFJACC4AhigImNGAwNVKDIqAKAAsUCRuRJG+YBI1IuLASc34PFqQ/IOdiWN4mAxYWNWJQYRpMBlGrEoMioAqKAsFBFgAYqgJiyGLATxSxrDAYxK3WbAYRqoAsJGgSRVkMBqRvljl24AnLUlVcBjFrSAwjeIDFZrdZsBhGqmAzUqoDKNVkFEaAaiQgKQUBqJigqRogM2VVAYxK2zQc6i1AWN4zy3AMUkUE5deI48u3NB0ipy3OQZw9tAObNdKxQZsZrVTqAxUrTNBlmtYlBmsrUBVjLUBVRYCxYiguLILACUjYMkUkBnpit2MUGKzFqA1HSOfLfINRfZzFyg48124rhzXTnoHo5rpzXDnpuUHRLRLQRCgM1mtM2AzUtWs0ErFarFBKgAKgDcWMytQGljMagEaiUlBZV5rK6DWpp1WbQOqxatrFoM1BAbjpK5StSg681q9OcrcoPPHTliOnIN8uvFY5jfINyialBe2L9/ZagIlDyBnpjqtWs0GazW6xQRFQFgigsUiwFVIsoNUTVgLrVc9UGrUtKlBjpiulYsBmoqAqxI1Ab5b1iNT2DnzHTlzjfIO0ajnzWp1Qa/ozpQES/KAVmlTqglpUZBazVQERUBRFBYqQgNEZXQakajGqDWrIyugolTQWsVbWQZoUBY3IxFB0i4xKu0GJXTmuUblB01rXPV0GtWM6mgtS1NQDUtKzoAgAgAgACoAoAKRAGtEUFWMmg1KgaBUtEBEVAWNRlQalXWYeQMxqVlYDeqxKoNCQANZAKlAEAAQAAAAAFQBQAFQBTEUAEAAAQAURQVWV0GVQBo1AGjUQFEAAAEAAAAAAAAAAAFQAURQAAQAAAAAFEUEABYAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAALAAABagAUACgAgAAAAAAAAAAACxAAAFKgAAAAAAAAD//Z"
      class="card-img-top" alt="..." style="max-width: 100%;height: 50vh;" />

    <div class="card-body" style="background-color:black;color:white">
      <div style="display:inline-block; font-weight:bold">
        <a href="#">{{this.course.CatName}}</a>
        <i class="fa-solid fa-chevron-right"></i>
        <a href="#">{{this.course.TopicName}}</a>
        <br />
        <br />
      </div>
      <h1 class="card-title">{{this.course.Name}}</h1>
      <p class="card-text" style="font-size:x-large;">{{this.course.TinyDesc}}</p>

      <p class="card-text" style="font-size:medium;">Instructor:
        {{this.course.Instructor}}</p>

      <p class="card-text" style="font-size:medium;">Total Lecture:
        {{this.course.TotalLecture}}
        lectures
        <br />
        Total Length:
        {{this.course.TotalLength}}
        hours
      </p>

      <p class="card-text" style="font-size:medium;">Average rating:
        {{this.course.AvgRating}}/5</p>
      <p class="card-text" style="font-size:medium;">Number of rating: 500k+</p>
      <p class="card-text" style="font-size:medium;">Number of student: 1m+</p>
      <p class="card-text"><small class="text-muted">Last modify:
          {{this.course.ModifiedTime}}mm/dd/yyyy</small></p>

    </div>

  </div>
  <div class="row">
    <div class="col-8">
      <div style="padding:10%; padding-top:0%">
        <div class="card">
          <div class="card-body">

            <h5 class="card-title">&nbsp;<i class="fa-solid fa-check"></i>
              &nbsp; What you will learn in this course</h5>
            <p class="card-text">
              {{{this.course.FullDesc}}}
            </p>

          </div>
        </div>
        <br />
        <h3>Course's Contents</h3>

        <style>
          .chapter {
            border-bottom: 1px dotted #ccc;
            padding: 1em 0;
          }

          .icon_drop {
            font-size: xx-large;
            line-height: 1em;
            color: #aaa;
            font-family:
              sans-serif;
            float: left;
            font-weight: 700;
            padding-right: 0.3em;
            -webkit-transition: all 200ms;
            -moz-transition: all 200ms;
            transition:
              all 200ms;
          }

          .effect_icon_drop {
            transform: rotate(-45deg);
            transform-origin: 50% 50%;
            -ms-transform: rotate(-45deg);
            -ms-transform-origin: 50% 50%;
            -webkit-transform: rotate(-45deg);
            -webkit-transform-origin: 50% 50%;
            -webkit-transition: all 200ms;
            -moz-transition: all 200ms;
            transition: all 200ms;
          }

          .chapter_content {
            cursor: pointer;
            font-size: 1.5em;
            font-weight: 100;
          }

          .lecture {
            clear:
              both;
            color: #666;
            display: none;
            padding-left: 1.5em;
          }
        </style>
        {{#each this.chapters as |chapter|}}
        <div class="chapter">
          <div class="chapter_content">
            <span class="icon_drop">+</span>{{chapter.Name}}
          </div>
          <div class="lecture" id="lecture">
            <div class="card">

              {{#each (lookup ../videos @index) as |video|}}

              <li class="list-group-item">
                <div style="display: flex; justify-content:space-between">
                  <h6 class="text"><a
                      href="/course/{{video.IDCourse}}?chapterId={{video.IDChapter}}&lectureId={{video.No}}" 
                      style="text-decoration: none; color: black; pointer-events: none; cursor: default;"
                  >&nbsp; {{video.No}}. {{video.Name}} </a></h6>
                  {{#if video.IsPreview}}
                  <div class="preview" onclick="showPreview()" style="color: blue; cursor: pointer">Preview</div>
                  <script>
                    
                  </script>
                  {{/if}}
                </div>

                <div class="text" style="display: flex;justify-content: flex-end;"><i class="bi bi-clock"></i> &nbsp;
                  {{convertMinuteToHour video.Length}}</div>
              </li>
              {{/each}}

            </div>
          </div>
        </div>

        {{/each}}
      </div>
    </div>
    <div class="col-4">
      <div class="buy-course">
        <div class="card" style="width: 18rem;">
          <img src="../../public/images/categories/1/1.jpg" class="card-img-top" alt="...">
          <div class="card-body" style="display: flex; justify-content:center; flex-direction: column;">
            {{#if course.PercentDiscount}}
            <span class="old-price ">{{formatCurrency this.course.CourseFee}}</span>
            {{/if}}
            <span class="new-price float-right" style="font-size: 22px;">{{formatCurrency (calculateNewPrice
              this.course.PercentDiscount this.course.CourseFee)}}</span>

            <a href="#" class="btn btn-outline-primary">Add to watch list </a>
            <br>
            <a href="#" class="btn btn-outline-success">Buy now</a>
            <p class="card-text">Ensuring refund in 30days</p>
          </div>
        </div>
      </div>
      <div class="feedback">
        <div class="container justify-content-center mt-5 border-left border-right">
          <h3>Feedback</h3>
          {{#each this.feedback}}
          <div class="d-flex justify-content-flex-start py-2">
            <div class="second py-2 px-2">
              <div class="d-flex justify-content-between py-1 pt-2">
                <div><img src="https://uybor.uz/borless/avtobor/img/user-images/user_no_photo_600x600.png"
                    width="30"><span class="text2">
                    <h5>{{FullName}}</h5>
                  </span></div>
              </div>
              <span class="text1">{{Feedback}}</span>
              <div class="rating mt-1" rating_score={{#if Rating}}{{Rating}}{{else}}0{{/if}} rating_count={{Rating}}>
              </div>
              <script src="/public/script/rating.js"></script>
              <script> renderRating('.rating')</script>
            </div>
          </div>
          {{/each}}
        </div>
      </div>
    </div>
  </div>
  <div class='col ml-5'>
    <div class="outstanding-course mt-5">
      <p>Relevent Courses</p>
    </div>
    <div class="row">
      {{#if this.isEmpty}}
      <p>No data</p>
      {{else}}
      {{#each coursesList as |course|}}
      <div class="col-auto mt-3">
        <div class="card product-item popover-{{course.ID}}" style="max-width:300px; min-width:300px">
          <img src="/public/images/courses/{{course.ID}}.jpg" width="250" height="150" style="object-fit: fill;"
            class="card-img-top" alt="...">
          <div class="card-body">
            <a href="/course?id={{course.ID}}">
              <h5 class="card-title product-title">{{course.Name}}</h5>
            </a>
            <span class="text-muted product-category">{{course.TopicName}}</span>
            <small class="text-muted">Ins: {{course.Instructor}}</small>
            <div class="rating mt-1" rating_score={{#if course.AvgRating}}{{course.AvgRating}}{{else}}0{{/if}}
              rating_count={{course.CountRating}}>
            </div>
            <div class="product-price-wrapper mt-3">
              {{#if course.PercentDiscount}}
              <span class="old-price ">{{formatCurrency course.CourseFee}}</span>
              {{/if}}
              <span class="new-price float-right" style="font-size: 22px;">{{formatCurrency (calculateNewPrice
                course.PercentDiscount course.CourseFee)}}</span>
            </div>
          </div>
        </div>
      </div>
      {{/each}}
      {{/if}}
    </div>
    <div class="page-container">
      <div id="pagination"></div>
    </div>
  </div>
  {{/if}}
</div>